// 部门表
model Department {
  id             String  @id @default(cuid())
  name           String // 部门名称
  code           String  @unique // 部门编码
  description    String? // 部门描述
  organizationId String // 所属组织ID
  parentId       String? // 父部门ID
  level          Int     @default(1) // 部门层级
  sortOrder      Int     @default(0) // 排序
  active         Boolean @default(true) // 是否启用

  // 关联关系
  organization Organization     @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  parent       Department?      @relation("DepartmentHierarchy", fields: [parentId], references: [id], onDelete: Restrict)
  children     Department[]     @relation("DepartmentHierarchy")
  users        UserDepartment[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([organizationId])
  @@index([parentId])
  @@index([code])
  @@index([organizationId, active]) // 活跃部门查询
  @@index([parentId, sortOrder]) // 子部门排序查询
  @@map("departments")
}
